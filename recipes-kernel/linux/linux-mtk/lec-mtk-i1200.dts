// SPDX-License-Identifier: (GPL-2.0 OR MIT)
/*
 * Copyright (C) 2023 MediaTek Inc.
 * Author: Ben Lok <ben.lok@mediatek.com>
 */
/dts-v1/;
#include "mt8195-iot-usb.dtsi"
#include "mt6359.dtsi"
#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/input/input.h>
#include <dt-bindings/interrupt-controller/irq.h>
#include <dt-bindings/pinctrl/mt8195-pinfunc.h>
#include <dt-bindings/usb/pd.h>
#include <dt-bindings/net/ti-dp83867.h>

/ {
	model = "Adlinktech LEC-MTK-I1200 board";
	compatible = "mediatek,mt8395-evk", "mediatek,mt8195";

	aliases {
		serial0 = &uart0;
		i2c0 = &i2c0;
		i2c1 = &i2c1;
		i2c2 = &i2c2;
		i2c3 = &i2c3;
		i2c4 = &i2c4;
		i2c6 = &i2c6;
		rtc0 = &pcf8563;
		rtc1 = &mt6359rtc;

	};

	chosen {
		stdout-path = "serial0:921600n8";
	};

	memory@40000000 {
		device_type = "memory";
		reg = <0 0x40000000 0x1 0x00000000>;
	};

	reserved-memory {
		#address-cells = <2>;
		#size-cells = <2>;
		ranges;

		/* 12 MiB reserved for OP-TEE (BL32)
		 * +-----------------------+ 0x43e0_0000
		 * |      SHMEM 2MiB       |
		 * +-----------------------+ 0x43c0_0000
		 * |        | TA_RAM  8MiB |
		 * + TZDRAM +--------------+ 0x4340_0000
		 * |        | TEE_RAM 2MiB |
		 * +-----------------------+ 0x4320_0000
		 */
		optee_reserved: optee@43200000 {
			no-map;
			reg = <0 0x43200000 0 0x00c00000>;
		};

		scp_mem_reserved: scp_mem_region {
			compatible = "shared-dma-pool";
			reg = <0 0x50000000 0 0x2900000>;
			no-map;
		};

		/* 2 MiB reserved for ARM Trusted Firmware (BL31) */
		bl31_secmon_reserved: secmon@54600000 {
			no-map;
			reg = <0 0x54600000 0x0 0x200000>;
		};

		snd_dma_mem_reserved: snd_dma_mem_region {
			compatible = "shared-dma-pool";
			reg = <0 0x60000000 0 0x1100000>;
			no-map;
		};

		apu_reserve_memory: apu-reserve-memory{
			compatible = "shared-dma-pool";
			size = <0 0x1400000>; //20 MB
			alignment = <0 0x10000>;
			reg = <0 0x62000000 0 0x1400000>;

		};

		vpu_reserve_memory: vpu-reserve-memory {
			compatible = "shared-dma-pool";
			size = <0 0x1400000>; //20 MB
			alignment = <0 0x10000>;
			reg = <0 0x53000000 0 0x1400000>;
		};
	};

	firmware {
		optee {
			compatible = "linaro,optee-tz";
			method = "smc";
		};
	};

	opp_table_apu_conn: opp-table-apu-conn {
		compatible = "operating-points-v2";

		opp-0 {
			opp-hz = /bits/ 64 <728000000>;
			opp-microvolt = <775000>;
		};
		opp-1 {
			opp-hz = /bits/ 64 <624000000>;
			opp-microvolt = <750000>;
		};
		opp-2 {
			opp-hz = /bits/ 64 <500000000>;
			opp-microvolt = <700000>;
		};
		opp-3 {
			opp-hz = /bits/ 64 <312000000>;
			opp-microvolt = <650000>;
		};
		opp-4 {
			opp-hz = /bits/ 64 <238000000>;
			opp-microvolt = <600000>;
		};
		opp-5 {
			opp-hz = /bits/ 64 <208000000>;
			opp-microvolt = <575000>;
		};
	};

	opp_table_apu_rv: opp-table-apu-rv {
		compatible = "operating-points-v2";

		opp-0 {
			opp-hz = /bits/ 64 <728000000>;
			opp-microvolt = <775000>;
		};
		opp-1 {
			opp-hz = /bits/ 64 <624000000>;
			opp-microvolt = <750000>;
		};
		opp-2 {
			opp-hz = /bits/ 64 <500000000>;
			opp-microvolt = <700000>;
		};
		opp-3 {
			opp-hz = /bits/ 64 <312000000>;
			opp-microvolt = <650000>;
		};
		opp-4 {
			opp-hz = /bits/ 64 <238000000>;
			opp-microvolt = <600000>;
		};
		opp-5 {
			opp-hz = /bits/ 64 <208000000>;
			opp-microvolt = <575000>;
		};
	};

	opp_table_vpu: opp-table-vpu {
		compatible = "operating-points-v2";

		opp-0 {
			opp-hz = /bits/ 64 <832000000>;
			opp-microvolt = <775000>;
		};
		opp-1 {
			opp-hz = /bits/ 64 <728000000>;
			opp-microvolt = <750000>;
		};
		opp-2 {
			opp-hz = /bits/ 64 <624000000>;
			opp-microvolt = <700000>;
		};
		opp-3 {
			opp-hz = /bits/ 64 <525000000>;
			opp-microvolt = <650000>;
		};
		opp-4 {
			opp-hz = /bits/ 64 <358000000>;
			opp-microvolt = <600000>;
		};
		opp-5 {
			opp-hz = /bits/ 64 <275000000>;
			opp-microvolt = <575000>;
		};
	};

	opp_table_dla: opp-table-dla {
		compatible = "operating-points-v2";

		opp-0 {
			opp-hz = /bits/ 64 <960000000>;
			opp-microvolt = <800000>;
		};
		opp-1 {
			opp-hz = /bits/ 64 <832000000>;
			opp-microvolt = <750000>;
		};
		opp-2 {
			opp-hz = /bits/ 64 <688000000>;
			opp-microvolt = <700000>;
		};
		opp-3 {
			opp-hz = /bits/ 64 <546000000>;
			opp-microvolt = <650000>;
		};
		opp-4 {
			opp-hz = /bits/ 64 <385000000>;
			opp-microvolt = <600000>;
		};
		opp-5 {
			opp-hz = /bits/ 64 <312000000>;
			opp-microvolt = <575000>;
		};
	};
        usb_otg_vbus: usb-otg-vbus-regulator {
                compatible = "regulator-fixed";
                regulator-name = "otg-vbus";
                regulator-min-microvolt = <5000000>;
                regulator-max-microvolt = <5000000>;
                enable-active-high;
        };

	clk20m: oscillator2 {
                compatible = "fixed-clock";
                #clock-cells = <0>;
                clock-frequency = <20000000>;
                clock-output-names = "clk20m";
        };
	
	backlight_lcd0: backlight-lcd0 {
		compatible = "pwm-backlight";
                pwms = <&disp_pwm0 0 500000>;
		enable-gpios = <&pio 95 GPIO_ACTIVE_HIGH>;
		brightness-levels = <0 1023>;
		num-interpolated-steps = <1023>;
		default-brightness-level = <576>;
	};

	backlight_lcd1: backlight-lcd1 {
		compatible = "pwm-backlight";
		pwms = <&disp_pwm1 0 500000>;
		enable-gpios = <&pio 61 GPIO_ACTIVE_HIGH>;
		brightness-levels = <0 1023>;
		num-interpolated-steps = <1023>;
		default-brightness-level = <576>;
	};

	edp_panel: panel {
		pinctrl-names = "default";
		pinctrl-0 = <&panel0_en_pin>;
	        compatible = "lg,lp120up1";
	        backlight = <&backlight_lcd0>;
	        label = "BOE NE135FBMN41 (WIP)";
	        width-mm = <285>;
	        height-mm = <190>;
		enable-gpios = <&pio 96 GPIO_ACTIVE_HIGH>;
	        status = "disabled";

	        port {
	                panel_in: endpoint {
	                        remote-endpoint = <&edp_out>;
	                };
	        };
	};
	
	mtk_fsource: fsource {
		compatible = "mtk-fsource";
		vfsource-supply = <&mt6359_vefuse_ldo_reg>;
	};
};

&uart0 {
	pinctrl-0 = <&uart0_pins>;
	pinctrl-names = "default";
	status = "okay";
};

&uart2 {
        pinctrl-0 = <&uart2_pins>;
        pinctrl-names = "default";
        status = "okay";
};

&uart3 {
        pinctrl-0 = <&uart3_pins>;
        pinctrl-names = "default";
        status = "okay";
};

&scp {
	status = "okay";
};

&pmic {
	interrupt-parent = <&pio>;
	interrupts = <222 IRQ_TYPE_LEVEL_HIGH>;
};

&scp {
	memory-region = <&scp_mem_reserved>;
	status = "okay";
};
/* I2C_CAM0 */
&i2c0 {
	clock-frequency = <400000>;
	pinctrl-0 = <&i2c0_pins>;
	pinctrl-names = "default";
	status = "okay";
};

/* I2C_CAM1 */
&i2c1 {
	clock-frequency = <400000>;
	pinctrl-0 = <&i2c1_pins>;
	pinctrl-names = "default";
	status = "okay";
};

/* I2C_PM */
&i2c2 {
	clock-frequency = <400000>;
	pinctrl-0 = <&i2c2_pins>;
	pinctrl-names = "default";
	status = "okay";
};

/* I2C_GP */
&i2c3 {
	clock-frequency = <400000>;
	pinctrl-0 = <&i2c3_pins>;
	pinctrl-names = "default";
	status = "okay";
       /* SX1509(2) U1001 on IPI-SMARC-PLUS */
        gpio2:gpio_exp2@3e {
                        /* GPIO Expander 0 Mapping :
                         * - 0: E_GPIO1_0		<=>
                         * - 1: E_GPIO1_1		<=>
                         * - 2: E_GPIO1_2		<=>
                         * - 3: E_GPIO1_3		<=>
                         * - 4: E_GPIO1_4		<=>
                         * - 5: E_GPIO1_5		<=>
                         * - 6: E_GPIO1_6		<=>
                         * - 7: E_GPIO1_7		<=>
                         * - 8: E_GPIO1_8		<=>
                         */
                        #gpio-cells = <2>;
                        #interrupt-cells = <2>;
                        compatible = "semtech,sx1509q";
                        reg = <0x3e>;
                        semtech,probe-reset;
                        gpio-controller;
        };

        tlv320aic310x: tlv320aic310x@18 {
			compatible = "ti,tlv320aic3x";
			#sound-dai-cells = <0>;
			reg = <0x18>;
			ai3x-micbias-vg = <2>; /* MICBIAS_2_5V */
			status = "okay";
        };

        wm8960: wm8960@1a {
            compatible = "wlf,wm8960";
            #sound-dai-cells = <0>;
            reg = <0x1a>;
            clocks = <&topckgen CLK_TOP_I2SO1_MCK>;
            clock-names = "top_i2so1_mck";
            wlf,shared-lrclk;
            wlf,hp-cfg = <2 3 3>;
            status = "disabled";
        };
};

/* I2C_SYS */
&i2c4 {
	clock-frequency = <100000>;  //crypto ic only can work on 100k clock frequency
	pinctrl-0 = <&i2c4_pins>;
	pinctrl-names = "default";
	status = "okay";

	/* EEPROM U3903 */
    eeprom: 24c04@52 {
		compatible = "atmel,24c04";
		reg = <0x52>;
	};

	/* RTC U4005 */
	pcf8563: rtc@51 {
		compatible = "nxp,pcf8563";
		reg = <0x51>;
		#clock-cells = <0>;
	};

	/* SX1509(0) U4006 */
	gpio0: gpio_exp0@3e {
			/* GPIO Expander 0 Mapping :
			 * - 0: LS_OE_CTL			 =>			Level Shifter oe pin(out high) 
			 * - 1: CN_GPIO7			<=>			SMARC GPIO7
			 * - 2: CN_GPIO8			<=>			SMARC GPIO8
			 * - 3: CN_GPIO9			<=>			SMARC GPIO9
			 * - 4: CN_GPIO10			<=>			SMARC GPIO10
			 * - 5: TPM_RST_N			 =>			TPM RST(out low / pull-high)
			 * - 6: TPM_PP				 =>			TPM PP (out high)
			 * - 7: TPM_LP				 =>			TPM LP (out high)
			 * - 8: SLEEP#				<=			SMARC SLEEP# (won't use)
			 * - 9: CHARGING#			<=			SMARC CHARGING# (won't use)
			 * - 10: BATLOW#			<=			SMARC BATLOW# (won't use)
			 * - 11: TEST#				<=			SMARC TEST# (won't use)
			 * - 12: LID#				<=			SMARC LID# (won't use)
			 * - 13: CN_GPIO11			<=>			SMARC GPIO11
			 * - 14: CN_GPIO12			<=>			SMARC GPIO12
			 * - 15: CN_GPIO13			<=>         SMARC GPIO13
			 */
			#gpio-cells = <2>;
			#interrupt-cells = <2>;
			compatible = "semtech,sx1509q";
			reg = <0x3e>;
			pinctrl-names = "default";
			pinctrl-0 = <&gpio_exp0_pins &ls_oe_ctl &tpm_pp &tpm_lp>;
			semtech,probe-reset;
			gpio-controller;
			interrupt-controller;

			interrupt-parent = <&pio>;
			interrupts = <55 IRQ_TYPE_EDGE_FALLING>;
                        ls_oe_ctl: gpio0-cfg {
                                pins = "gpio0";
                                output-high;
                        };
                        tpm_pp: gpio6-cfg {
                                pins = "gpio6";
                                output-high;
                        };
                        tpm_lp: gpio7-cfg {
                                pins = "gpio7";
                                output-high;
                        };

	};


	/* SX1509(1) U4007 */
	gpio1: gpio_exp1@3f {
                        /* GPIO Expander 0 Mapping :
                         * - 0: PRI_DISP_P0_3V3_SEL     =>      (out low)->DSI0 , (out high)->eDP0
                         * - 1: USB0_EN_OC#             <=      (input,NP)
                         * - 2: USB1_EN_OC#             <=      (input,NP)
                         * - 3: USB_HUB_3V3_RST_N       =>      (out high)
                         * - 4: USB_ETH1_3V3_RST_N      =>      (out high)
                         * - 5: WIFI_PowerDown#         =>      (out high)
                         * - 6: CAM2_PWR_EN             =>      (out high)
                         * - 7: CAM2_LED_EN             =>      (out high)
                         * - 8: PCIe_3V3_SEL		=>	(out high)->PCIe A/B for Gen 3 (out low)->PCIe A for Gen3 , PCIe B for Gen2
                         * - 9:
                         * - 10:
                         * - 11: BT_UART_RST_N          =>      (out high)
                         * - 12: USB_UART_RST_N         =>      (out high)
                         * - 13:
                         * - 14:
                         * - 15:
                         */
                        #gpio-cells = <2>;
                        #interrupt-cells = <2>;
                        compatible = "semtech,sx1509q";
                        reg = <0x3f>;
                        pinctrl-names = "default";
                        pinctrl-0 = <&gpio_exp1_pins &pri_disp_p0_3v3_sel1 &usb0_en_oc &usb1_en_oc &usb_hub_3v3_rst_n &usb_eth1_3v3_rst_n &wifi_powerdown &cam2_pwr_en &cam2_led_en &pcie_3v3_sel &bt_uart_rst_n &usb_uart_rst_n>;
                        semtech,probe-reset;
                        gpio-controller;
                        interrupt-controller;

                        interrupt-parent = <&pio>;
                        interrupts = <56 IRQ_TYPE_EDGE_FALLING>;
                        pri_disp_p0_3v3_sel1: gpio01-cfg {
                                pins = "gpio0";
                                output-low;
                        };
                        pri_disp_p0_3v3_sel2: gpio02-cfg {
                                pins = "gpio0";
                                output-high;
                        };
                        usb0_en_oc: gpio1-cfg {
                                pins = "gpio1";
                                bias-pull-up;
                        };
                        usb1_en_oc: gpio2-cfg {
                                pins = "gpio2";
                                bias-pull-up;
                        };
                        usb_hub_3v3_rst_n: gpio3-cfg {
                                pins = "gpio3";
                                output-high;
                        };
                        usb_eth1_3v3_rst_n: gpio4-cfg {
                                pins = "gpio4";
                                output-high;
                        };
                        wifi_powerdown: gpio5-cfg {
                                pins = "gpio5";
                                output-low;
                        };
                        cam2_pwr_en: gpio6-cfg {
                                pins = "gpio6";
                                output-high;
                        };
                        cam2_led_en: gpio7-cfg {
                                pins = "gpio7";
                                output-high;
                        };
                        pcie_3v3_sel: gpio8-cfg {
                                pins = "gpio8";
                                output-high;
                        };
                        bt_uart_rst_n: gpio11-cfg {
                                pins = "gpio11";
                                output-high;
                        };
                        usb_uart_rst_n: gpio12-cfg {
                                pins = "gpio12";
                                output-high;
                        };
	};

	/* TPM - ST33TPHF2XI2C U2301 */
	st33tphf2xi2c@2e {
		#gpio-cells = <2>;
		#interrupt-cells = <2>;
		compatible = "st,st33htpm-i2c";
		reg = <0x2e>;
		label = "tpm";
		pinctrl-names = "default";
		pinctrl-0 = <&tpm_pins>;
		interrupt-parent = <&pio>;
		interrupts = <125 IRQ_TYPE_LEVEL_LOW>;
		reset-gpio = <&gpio0 5 GPIO_ACTIVE_LOW>;
		status = "okay";
	};

};
 
&i2c6 {
	clock-frequency = <400000>;
	pinctrl-0 = <&i2c6_pins>;
	pinctrl-names = "default";
	#address-cells = <1>;
	#size-cells = <0>;
	status = "okay";

	mt6360: mt6360@34 {
		compatible = "mediatek,mt6360";
		reg = <0x34>;
		pinctrl-0 = <&mt6360_pins>;
		pinctrl-names = "default";
		interrupts = <101 IRQ_TYPE_EDGE_FALLING>;
	};
};

&spi0 {
	pinctrl-0 = <&spi0_pins>;
	pinctrl-names = "default";
	mediatek,pad-select = <0>;
	status = "okay";

	can0: can@0 {
		compatible = "microchip,mcp2518fd";
		reg = <0>;
		clocks = <&clk20m>;
		pinctrl-names = "default";
		pinctrl-0 = <&can0_pins>;
		spi-max-frequency = <20000000>;
		interrupts-extended = <&pio 23 IRQ_TYPE_LEVEL_LOW>;
		vdd-supply = <3300000>;
		xceiver-supply = <3300000>;

	};
};

&spi1 {
	pinctrl-0 = <&spi1_pins>;
	pinctrl-names = "default";
	mediatek,pad-select = <0>;
	#address-cells = <1>;
	#size-cells = <0>;
	status = "okay";

	spidev@0 {
		compatible = "rohm,dh2228fv";
		spi-max-frequency = <5000000>;
		reg = <0>;
	};
};

&spi2 {
	pinctrl-0 = <&spi2_pins>;
	pinctrl-names = "default";
	mediatek,pad-select = <0>;
	#address-cells = <1>;
	#size-cells = <0>;
	status = "okay";

        w25q64dw: spi-flash@0 {
                compatible = "winbond,w25q64dw", "jedec,spi-nor";
                reg = <0>;
                spi-max-frequency = <25000000>;
        };
};

&ssusb {
        pinctrl-0 = <&usb_p0_pins>;
        pinctrl-names = "default";
        maximum-speed = "super-speed";
        vusb33-supply = <&mt6359_vusb_ldo_reg>;
        usb-role-switch;
        dr_mode = "host";
        status = "okay";
};

&ssusb1 {
        pinctrl-0 = <&usb_p2_pins>;
        pinctrl-names = "default";
        maximum-speed = "high-speed";
        usb-role-switch;
        dr_mode = "otg";
        vusb33-supply = <&mt6359_vusb_ldo_reg>;
        status = "okay";

        connector {
                compatible = "gpio-usb-b-connector", "usb-b-connector";
                type = "micro";
                id-gpios = <&pio 130 GPIO_ACTIVE_HIGH>;
                vbus-supply = <&usb_otg_vbus>;
        };
};

&edp_tx {
	pinctrl-names = "default";
	pinctrl-0 = <&edp_pin>;
	status = "disabled";

        ports {
                #address-cells = <1>;
                #size-cells = <0>;

                port@0 {
                        reg = <0>;
                        edp_in: endpoint {
                        remote-endpoint = <&dp_intf0_out>;
                        };
                };

                port@1 {
                        reg = <1>;
                        edp_out: endpoint {
                                remote-endpoint = <&panel_in>;
                        };
                };
        };
};


&dp_intf0 {
	status = "disabled";
        ports {
                port {
                        dp_intf0_out: endpoint {
                                remote-endpoint = <&edp_in>;
                        };
                };
        };
};


&xhci0 {
	vusb33-supply = <&mt6359_vusb_ldo_reg>;
	mediatek,phy-regs = <0x11e40000>; // for compliance test mode
	status = "okay";
};

&xhci1 { //WIFI&BT
	vusb33-supply = <&mt6359_vusb_ldo_reg>;
	mediatek,phy-regs = <0x11e30000>; // for compliance test mode
	mediatek,u3p-dis-msk = <1>;
	status = "okay";
};

&xhci2 {
	vusb33-supply = <&mt6359_vusb_ldo_reg>;
	mediatek,phy-regs = <0x11c40000>; // for compliance test mode
	status = "okay";
};

&xhci3 {	//SMARC USB1
	vusb33-supply = <&mt6359_vusb_ldo_reg>;
	mediatek,phy-regs = <0x11c50000>; // for compliance test mode
	status = "okay";
};

&u3port0 {
	status = "okay";
};

&u2port1 {
	status = "okay";
};

&u2port2 {
	status = "okay";
};

&u2port3 {
	status = "okay";
};

&u3phy0 {
	status = "okay";
};

&u3phy1 {
	status = "okay";
};

&u3phy2 {
	status = "okay";
};

&u3phy3 {
	status = "okay";
};

&mipi_tx0 {
	status = "disabled";
};

&dsi0 {
	status = "disabled";
	#address-cells = <1>;
	#size-cells = <0>;
	poweron-in-hs-mode = <0>;
	dsi_panel@0 {
		compatible = "auo,b101uan01v7";
		reg = <0>;
		enable-gpios = <&pio 96 0>;
		pinctrl-names = "default";
		pinctrl-0 = <&panel0_en_pin>;
		backlight = <&backlight_lcd0>;
		status = "okay";
		port {
			dsi_panel_in: endpoint {
				remote-endpoint = <&dsi_out>;
			};
		};
	};
	ports {
		port {
			dsi_out: endpoint {
				remote-endpoint = <&dsi_panel_in>;
			};
		};
	};
};

&disp_pwm0 {
	pinctrl-names = "default";
	pinctrl-0 = <&pwm0_gpio_def_cfg>;
	status = "disabled";
};

&disp_pwm1 {
	pinctrl-names = "default";
	pinctrl-0 = <&pwm1_gpio_def_cfg>;
	status = "disabled";
};

&eth {
    phy-mode ="rgmii-rxid";
    phy-handle = <&dp83867>;
    pinctrl-names = "default";
    pinctrl-0 = <&eth_default>;
    snps,reset-active-low;
    snps,reset-delays-us = <0 10000 10000>;
    mediatek,tx-delay-ps = <2030>;
    snps,reset-gpio = <&pio 93 GPIO_ACTIVE_HIGH>;
    eeprom = <&eeprom>;
    status = "okay";

	mdio {
		compatible = "snps,dwmac-mdio";
		#address-cells = <1>;
		#size-cells = <0>;

		dp83867: ethernet-phy@0 {
				compatible = "ethernet-phy-ieee802.3-c22";
				reg = <0>;
				interrupt-parent = <&pio>;
				interrupts = <94 IRQ_TYPE_EDGE_FALLING>;

				ti,rx-internal-delay = <DP83867_RGMIIDCTL_2_25_NS>;
				ti,tx-internal-delay = <DP83867_RGMIIDCTL_3_00_NS>;
				ti,fifo-depth = <DP83867_PHYCR_FIFO_DEPTH_4_B_NIB>;
				ti,clk-output-sel = <DP83867_CLK_O_SEL_OFF>;
		};
	};
};

&pio {
        sw_wdt {
                gpio-hog;
                gpios = <24 GPIO_ACTIVE_HIGH>;
                output-high;
                line-name = "SW_WDT";
        };

        pcie_disable {
                gpio-hog;
                gpios = <124 GPIO_ACTIVE_HIGH>;
                output-high;
                line-name = "PCI_W_DISABLE";

        };

	sdio_pwr_en {
		gpio-hog;
		gpios = <47 GPIO_ACTIVE_HIGH>;
		output-high;
		line-name = "SDIO_PWR_EN";
	};

	soc_status {
		gpio-hog;
		gpios = <54 GPIO_ACTIVE_HIGH>;
		output-high;
		line-name = "Soc_STATUS";
	};

	usb_p0_p2_mux_sel {
		gpio-hog;
		gpios = <3 GPIO_ACTIVE_HIGH>;
		output-high;  //USB P2 <--> SMARC OTG
		line-name = "USB_P0_P2_MUX_SEL";
	};

        usb_p0_pins: usb_p0_pins {
                pin_iddig {
                        pinmux = <PINMUX_GPIO128__FUNC_IDDIG>;
                        input-enable;
                        bias-pull-up;
                };
                pins_cmd_dat {
                        pinmux = <PINMUX_GPIO63__FUNC_VBUSVALID>;
                        input-enable;
                        bias-pull-up;
                };
        };

        usb_p2_pins: usb_p2_pins {
                pin_iddig {
                        pinmux = <PINMUX_GPIO130__FUNC_IDDIG_1P>;
                        input-enable;
                        bias-pull-up;
                };
                pin_cmd_dat {
                        pinmux = <PINMUX_GPIO102__FUNC_VBUSVALID_2P>;
                        input-enable;
                        bias-pull-up;
                };
        };

	mmc1_pins_default: mmc1-pins-default {
		pins_cmd_dat {
			pinmux = <PINMUX_GPIO110__FUNC_MSDC1_CMD>,
				 <PINMUX_GPIO112__FUNC_MSDC1_DAT0>,
				 <PINMUX_GPIO113__FUNC_MSDC1_DAT1>,
				 <PINMUX_GPIO114__FUNC_MSDC1_DAT2>,
				 <PINMUX_GPIO115__FUNC_MSDC1_DAT3>;
			input-enable;
			drive-strength = <MTK_DRIVE_16mA>;
			bias-pull-up = <MTK_PUPD_SET_R1R0_01>;
		};

		pins_clk {
			pinmux = <PINMUX_GPIO111__FUNC_MSDC1_CLK>;
			drive-strength = <MTK_DRIVE_16mA>;
			bias-pull-down = <MTK_PUPD_SET_R1R0_10>;
		};

		pins_insert {
			pinmux = <PINMUX_GPIO129__FUNC_GPIO129>;
			bias-pull-up;
		};

	        pins_wp {
	            pinmux = <PINMUX_GPIO46__FUNC_GPIO46>;
	            input-enable;
	            bias-pull-up;
	        };

	};

	mmc1_pins_uhs: mmc1-pins-uhs {
		pins_cmd_dat {
			pinmux = <PINMUX_GPIO110__FUNC_MSDC1_CMD>,
				 <PINMUX_GPIO112__FUNC_MSDC1_DAT0>,
				 <PINMUX_GPIO113__FUNC_MSDC1_DAT1>,
				 <PINMUX_GPIO114__FUNC_MSDC1_DAT2>,
				 <PINMUX_GPIO115__FUNC_MSDC1_DAT3>;
			input-enable;
			drive-strength = <MTK_DRIVE_16mA>;
			bias-pull-up = <MTK_PUPD_SET_R1R0_01>;
		};

		pins_clk {
			pinmux = <PINMUX_GPIO111__FUNC_MSDC1_CLK>;
			drive-strength = <MTK_DRIVE_16mA>;
			bias-pull-down = <MTK_PUPD_SET_R1R0_10>;
		};
	};

	panel_pins_default: panel_pins_default {
		pins_cmd_dat {
			pinmux = <PINMUX_GPIO108__FUNC_GPIO108>,
				<PINMUX_GPIO137__FUNC_GPIO137>;
			output-high;
		};
	};

	pwm0_gpio_def_cfg: pwm0default {
		pins_cmd_dat {
			pinmux = <PINMUX_GPIO97__FUNC_DISP_PWM0>;
		};
	};
	
	pwm1_gpio_def_cfg: pwm1default {
		pins_cmd_dat {
			pinmux = <PINMUX_GPIO104__FUNC_DISP_PWM1>;
		};
	};

	aud_pins_default: audiodefault {
		pins_cmd_dat {
			pinmux = <PINMUX_GPIO49__FUNC_I2SIN_D0>,
				 <PINMUX_GPIO50__FUNC_I2SO1_MCK>,
				 <PINMUX_GPIO51__FUNC_I2SO1_BCK>,
				 <PINMUX_GPIO52__FUNC_I2SO1_WS>,
				 <PINMUX_GPIO53__FUNC_I2SO1_D0>;
		};
	};


	i2c0_pins: i2c0-pins {
		pins {
			pinmux = <PINMUX_GPIO8__FUNC_SDA0>,
				 <PINMUX_GPIO9__FUNC_SCL0>;
			bias-pull-up = <MTK_PULL_SET_RSEL_111>;
			mediatek,drive-strength-adv = <7>;
		};
	};

	i2c1_pins: i2c1-pins {
		pins {
			pinmux = <PINMUX_GPIO10__FUNC_SDA1>,
				 <PINMUX_GPIO11__FUNC_SCL1>;
			bias-pull-up = <MTK_PULL_SET_RSEL_111>;
			mediatek,drive-strength-adv = <7>;
		};
	};

	i2c2_pins: i2c2-pins {
		pins {
			pinmux = <PINMUX_GPIO12__FUNC_SDA2>,
				 <PINMUX_GPIO13__FUNC_SCL2>;
			bias-pull-up = <MTK_PULL_SET_RSEL_111>;
			mediatek,drive-strength-adv = <7>;
		};
	};

	i2c3_pins: i2c3-pins {
		pins {
			pinmux = <PINMUX_GPIO14__FUNC_SDA3>,
				 <PINMUX_GPIO15__FUNC_SCL3>;
			bias-pull-up = <MTK_PULL_SET_RSEL_111>;
			mediatek,drive-strength-adv = <7>;
		};
	};

	i2c4_pins: i2c4-pins {
		pins {
			pinmux = <PINMUX_GPIO16__FUNC_SDA4>,
				 <PINMUX_GPIO17__FUNC_SCL4>;
			bias-pull-up = <MTK_PULL_SET_RSEL_111>;
			mediatek,drive-strength-adv = <7>;
		};
	};
	i2c6_pins: i2c6-pin {
		pins {
			pinmux = <PINMUX_GPIO25__FUNC_SDA6>,
				 <PINMUX_GPIO26__FUNC_SCL6>;
			bias-pull-up;

		};
	};
	
	uart0_pins: uart0-pins {
		pins {
		    pinmux = <PINMUX_GPIO98__FUNC_UTXD0>,
		         <PINMUX_GPIO99__FUNC_URXD0>;
		};
	};

	uart2_pins: uart2-pins {
		pins {
		    pinmux = <PINMUX_GPIO27__FUNC_UCTS2>,
		         <PINMUX_GPIO28__FUNC_URTS2>,
		         <PINMUX_GPIO29__FUNC_UTXD2>,
		         <PINMUX_GPIO30__FUNC_URXD2>;
		};
	};

	uart3_pins: uart3-pins {
		pins {
		    pinmux = <PINMUX_GPIO4__FUNC_UTXD3>,
		         <PINMUX_GPIO5__FUNC_URXD3>;
		};
	};
	

	spi0_pins: spi0-pins {
		pins {
			pinmux = <PINMUX_GPIO132__FUNC_SPIM0_CSB>,
				 <PINMUX_GPIO133__FUNC_SPIM0_CLK>,
				 <PINMUX_GPIO134__FUNC_SPIM0_MO>,
				 <PINMUX_GPIO135__FUNC_SPIM0_MI>;
			bias-disable;
		};
	};

	spi1_pins: spi1-pins {
		pins {
			pinmux = <PINMUX_GPIO136__FUNC_SPIM1_CSB>,
				 <PINMUX_GPIO137__FUNC_SPIM1_CLK>,
				 <PINMUX_GPIO138__FUNC_SPIM1_MO>,
				 <PINMUX_GPIO139__FUNC_SPIM1_MI>;
			bias-disable;
		};
	};

	spi2_pins: spi2-pins {
		pins {
			pinmux = <PINMUX_GPIO140__FUNC_SPIM2_CSB>,
				 <PINMUX_GPIO141__FUNC_SPIM2_CLK>,
				 <PINMUX_GPIO142__FUNC_SPIM2_MO>,
				 <PINMUX_GPIO143__FUNC_SPIM2_MI>;
			bias-disable;
		};
	};

	eth_default: eth_default {
		txd_pins {
			pinmux = <PINMUX_GPIO77__FUNC_GBE_TXD3>,
				 <PINMUX_GPIO78__FUNC_GBE_TXD2>,
				 <PINMUX_GPIO79__FUNC_GBE_TXD1>,
				 <PINMUX_GPIO80__FUNC_GBE_TXD0>;
			drive-strength = <MTK_DRIVE_8mA>;
		};
		cc_pins {
			pinmux = <PINMUX_GPIO85__FUNC_GBE_TXC>,
				 <PINMUX_GPIO88__FUNC_GBE_TXEN>,
				 <PINMUX_GPIO87__FUNC_GBE_RXDV>,
				 <PINMUX_GPIO86__FUNC_GBE_RXC>;
			drive-strength = <MTK_DRIVE_8mA>;
		};
		rxd_pins {
			pinmux = <PINMUX_GPIO81__FUNC_GBE_RXD3>,
				 <PINMUX_GPIO82__FUNC_GBE_RXD2>,
				 <PINMUX_GPIO83__FUNC_GBE_RXD1>,
				 <PINMUX_GPIO84__FUNC_GBE_RXD0>;
		};
		mdio_pins {
			pinmux = <PINMUX_GPIO89__FUNC_GBE_MDC>,
				 <PINMUX_GPIO90__FUNC_GBE_MDIO>;
			input-enable;
		};
		phy_reset_pin {
			pinmux = <PINMUX_GPIO93__FUNC_GPIO93>;
		};
		phy_intr_pin {
			pinmux = <PINMUX_GPIO94__FUNC_GPIO94>;
		};
	};

	eth_sleep: eth_sleep {
		txd_pins {
			pinmux = <PINMUX_GPIO77__FUNC_GPIO77>,
				 <PINMUX_GPIO78__FUNC_GPIO78>,
				 <PINMUX_GPIO79__FUNC_GPIO79>,
				 <PINMUX_GPIO80__FUNC_GPIO80>;
		};
		cc_pins {
			pinmux = <PINMUX_GPIO85__FUNC_GPIO85>,
				 <PINMUX_GPIO88__FUNC_GPIO88>,
				 <PINMUX_GPIO87__FUNC_GPIO87>,
				 <PINMUX_GPIO86__FUNC_GPIO86>;
		};
		rxd_pins {
			pinmux = <PINMUX_GPIO81__FUNC_GPIO81>,
				 <PINMUX_GPIO82__FUNC_GPIO82>,
				 <PINMUX_GPIO83__FUNC_GPIO83>,
				 <PINMUX_GPIO84__FUNC_GPIO84>;
		};
		mdio_pins {
			pinmux = <PINMUX_GPIO89__FUNC_GPIO89>,
				 <PINMUX_GPIO90__FUNC_GPIO90>;
			input-disable;
			bias-disable;
		};
		phy_reset_pin {
			pinmux = <PINMUX_GPIO93__FUNC_GPIO93>;
			input-disable;
			bias-disable;
		};
		phy_intr_pin {
			pinmux = <PINMUX_GPIO94__FUNC_GPIO94>;
		};
	};

	pcie0_pins_default: pcie0default {
		pins {
			pinmux = <PINMUX_GPIO19__FUNC_WAKEN>,
				 <PINMUX_GPIO20__FUNC_PERSTN>,
				 <PINMUX_GPIO21__FUNC_CLKREQN>;
			bias-pull-up;
		};
	};

	pcie0_pins_idle: pcie0idle {
		pins {
			pinmux = <PINMUX_GPIO20__FUNC_GPIO20>;
			bias-disable;
			output-low;
		};
	};

	pcie1_pins_default: pcie1default {
		pins {
			pinmux = <PINMUX_GPIO0__FUNC_PERSTN_1>,
				 <PINMUX_GPIO1__FUNC_CLKREQN_1>,
				 <PINMUX_GPIO2__FUNC_WAKEN_1>;
			bias-pull-up = <MTK_PUPD_SET_R1R0_01>;
		};
	};

	can0_pins: can0-pins {
		pins {
		    pinmux = <PINMUX_GPIO23__FUNC_GPIO23>;
		};
	};
	
	tpm_pins: tpm-pins {
		pins {
		    pinmux = <PINMUX_GPIO125__FUNC_GPIO125>;
		};
	};
	
	gpio_exp0_pins: gpio-exp0-pins {
		pins {
		    pinmux = <PINMUX_GPIO55__FUNC_GPIO55>;
		};
	};

	gpio_exp1_pins: gpio-exp1-pins {
		pins {
		    pinmux = <PINMUX_GPIO56__FUNC_GPIO56>;
		};
	};

	mt6360_pins: mt6360-pins {
		pins {
			pinmux = <PINMUX_GPIO100__FUNC_GPIO100>,
				 <PINMUX_GPIO101__FUNC_GPIO101>;
			input-enable;
			bias-pull-up;
		};
	};

	dptx_pin: dptx_pin_default {
		pins_cmd_dat1 {
			pinmux = <PINMUX_GPIO18__FUNC_DP_TX_HPD>;
			bias-pull-up;
		};
	};

        hdmi_pins: hdmi-pins {
                pins-ddc {
                        pinmux = <PINMUX_GPIO34__FUNC_HDMITX20_SCL>,
                                <PINMUX_GPIO35__FUNC_HDMITX20_SDA>;
                        mediatek,drive-strength-adv = <0>;
                        drive-strength = <MTK_DRIVE_10mA>;
                        bias-disable; //disabled default Pull Down setting for HDMI
                };
        };


         panel0_en_pin: panel-en-pin {
                 pins_cmd_dat {
                     pinmux = <PINMUX_GPIO96__FUNC_GPIO96>;
                 };
         };

         panel1_en_pin: panel-en-pin {
                 pins_cmd_dat {
                     pinmux = <PINMUX_GPIO62__FUNC_GPIO62>;
                 };
        };

	edp_pin: edp_pin_default {
		pins_cmd_dat {
		    pinmux = <PINMUX_GPIO105__FUNC_EDP_TX_HPD>;
		    bias-pull-up = <MTK_PUPD_SET_R1R0_01>;
		};
	};
};

&mt6359_vgpu11_buck_reg {
	regulator-always-on;
};

&mt6359_vsram_others_ldo_reg {
	regulator-always-on;
};

&mt6359_vpu_buck_reg {
	regulator-always-on;
};

&mt6359_vcore_buck_reg {
	regulator-always-on;
};

&mt6359_vproc1_buck_reg {
	regulator-always-on;
};

&mt6359_vproc2_buck_reg {
	regulator-always-on;
};

&mt6359_vsram_md_ldo_reg {
	regulator-always-on;
};

&mt6359_vbbck_ldo_reg {
	regulator-always-on;
};

&mt6359_vaud18_ldo_reg {
	regulator-always-on;
};

&mt6359_vio18_ldo_reg {
	regulator-always-on;
};

&mt6359_vrf12_ldo_reg {
	regulator-always-on;
};

&mt6359_vrf18_ldo_reg {
	regulator-always-on;
};

&mt6359_vufs_ldo_reg {
        regulator-always-on;
};

&mt6359_vemc_1_ldo_reg {
        regulator-always-on;
};

&mt6359_vcn33_2_bt_ldo_reg {
	regulator-min-microvolt = <3300000>;
	regulator-max-microvolt = <3300000>;
	regulator-always-on;
};

/* DEBUG: to remove */
&mt6359_vibr_ldo_reg {
	regulator-always-on;
};

#include "mt6360.dtsi"

/* For EMI_VDD2 */
&mt6360_buck1 {
	regulator-always-on;
};

/* For EMI_VDDQ */
&mt6360_buck2 {
	regulator-always-on;
};

/* V_2V5_PMU for eth0 */
&mt6360_ldo2 {
        regulator-min-microvolt = <2500000>;
        regulator-max-microvolt = <2500000>;
	regulator-always-on;
};

/* For EMI_VMDDR_EN */
&mt6360_ldo7 {
	regulator-always-on;
};

&mmc1 {
	pinctrl-names = "default", "state_uhs";
	pinctrl-0 = <&mmc1_pins_default>;
	pinctrl-1 = <&mmc1_pins_uhs>;
	cd-gpios = <&pio 129 GPIO_ACTIVE_LOW>;
	wp-gpios = <&pio 46 GPIO_ACTIVE_HIGH>;
	bus-width = <4>;
	max-frequency = <208000000>;
	cap-sd-highspeed;
	sd-uhs-sdr50;
	sd-uhs-sdr104;
	vmmc-supply = <&mt6360_ldo5>;
	vqmmc-supply = <&mt6360_ldo3>;
	status = "okay";
};

&spmi {
	#address-cells = <2>;
	#size-cells = <2>;
	grpid = <11>;

	mt6315_6: mt6315@6 {
		compatible = "mediatek,mt6315-regulator";
		reg = <0x6 0 0xb 1>;

		regulators {
			mt6315_6_vbuck1: vbuck1 {
				regulator-compatible = "vbuck1";
				regulator-name = "Vbcpu";
				regulator-min-microvolt = <300000>;
				regulator-max-microvolt = <1193750>;
				regulator-enable-ramp-delay = <256>;
				regulator-allowed-modes = <0 1 2 4>;
				regulator-always-on;
			};
		};
	};

	mt6315_7: mt6315@7 {
		compatible = "mediatek,mt6315-regulator";
		reg = <0x7 0 0xb 1>;

		regulators {
			mt6315_7_vbuck1: vbuck1 {
				regulator-compatible = "vbuck1";
				regulator-name = "Vgpu";
				regulator-min-microvolt = <300000>;
				regulator-max-microvolt = <1193750>;
				regulator-enable-ramp-delay = <256>;
				regulator-allowed-modes = <0 1 2 4>;
				regulator-always-on;
			};
		};
	};
};

&afe {
	#sound-dai-cells = <0>;
	memory-region = <&snd_dma_mem_reserved>;
	mediatek,etdm-out1-multi-pin-mode = <1>;
	mediatek,dmic-iir-on;
	mediatek,etdm-in2-cowork-source=<2>;
	etdm-in2-cowork-source=<2>;
	status = "okay";
};

&mt6359codec {
	mediatek,mic-type-1 = <3>; /* DCC */
};

&sound {
	compatible = "mediatek,mt8395-evk";
	model = "mt8195_demo";
	pinctrl-names = "default";
	pinctrl-0 = <&aud_pins_default>;
	status = "okay";

	dai-link-0 {
		sound-dai = <&afe>;
		dai-link-name = "ETDM3_OUT_BE";

		codec-0 {
			sound-dai = <&hdmi0>;
		};
	};

	dai-link-1 {
		sound-dai = <&afe>;
		dai-link-name = "ETDM1_OUT_BE";
		codec-0 {
			sound-dai = <&tlv320aic310x>;
		};
	};

};

&mfg0 {
	domain-supply = <&mt6315_7_vbuck1>;
};

&pcie0 {
	pinctrl-names = "default", "idle";
	pinctrl-0 = <&pcie0_pins_default>;
	pinctrl-1 = <&pcie0_pins_idle>;
	status = "okay";
};

&pcie1 {
	pinctrl-names = "default";
	pinctrl-0 = <&pcie1_pins_default>;
	status = "okay";
	pd-gpios = <&gpio1 5 GPIO_ACTIVE_LOW>;
};

&u3phy1 {
	status = "okay";
};

&pciephy {
	status = "okay";
};

&dp_intf1 {
	status = "disabled";
	mediatek,oob-hpd;
	ports {
		port {
			dp_intf1_out: endpoint {
				remote-endpoint = <&dptx_in>;
			};
		};
	};
};

&dp_tx {
	pinctrl-names = "default";
	pinctrl-0 = <&dptx_pin>;
	status = "disabled";

	ports {
		port {
			dptx_in: endpoint {
				remote-endpoint = <&dp_intf1_out>;
			};
		};
	};
};

&disp_dpi1 {
	status = "okay";
	mediatek,indicated-display-path = <1>;
};

&hdmi0 {
	status = "okay";
};


